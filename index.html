<!DOCTYPE html>
<html lang="ko" class="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>4ëŒ€ë³´í—˜ëšë”± ğŸ’¼</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<link rel="preconnect" href="https://cdn.jsdelivr.net">
<link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable-dynamic-subset.min.css" rel="stylesheet">
<script>
tailwind.config = {
  darkMode: 'class',
  theme: {
    extend: {
      fontFamily: { sans: ['Pretendard Variable', 'Pretendard', '-apple-system', 'BlinkMacSystemFont', 'sans-serif'] },
      colors: {
        border: 'hsl(var(--border))',
        input: 'hsl(var(--input))',
        ring: 'hsl(var(--ring))',
        background: 'hsl(var(--background))',
        foreground: 'hsl(var(--foreground))',
        primary: { DEFAULT: 'hsl(var(--primary))', foreground: 'hsl(var(--primary-foreground))' },
        muted: { DEFAULT: 'hsl(var(--muted))', foreground: 'hsl(var(--muted-foreground))' },
        accent: { DEFAULT: 'hsl(var(--accent))', foreground: 'hsl(var(--accent-foreground))' },
        card: { DEFAULT: 'hsl(var(--card))', foreground: 'hsl(var(--card-foreground))' },
      }
    }
  }
}
</script>
<style>
  :root {
    --background: 0 0% 100%;
    --foreground: 240 10% 3.9%;
    --card: 0 0% 100%;
    --card-foreground: 240 10% 3.9%;
    --primary: 221.2 83.2% 53.3%;
    --primary-foreground: 210 40% 98%;
    --muted: 240 4.8% 95.9%;
    --muted-foreground: 240 3.8% 46.1%;
    --accent: 240 4.8% 95.9%;
    --accent-foreground: 240 5.9% 10%;
    --border: 240 5.9% 90%;
    --input: 240 5.9% 90%;
    --ring: 221.2 83.2% 53.3%;
  }
  .dark {
    --background: 240 10% 3.9%;
    --foreground: 0 0% 98%;
    --card: 240 10% 5.9%;
    --card-foreground: 0 0% 98%;
    --primary: 217.2 91.2% 59.8%;
    --primary-foreground: 222.2 47.4% 11.2%;
    --muted: 240 3.7% 15.9%;
    --muted-foreground: 240 5% 64.9%;
    --accent: 240 3.7% 15.9%;
    --accent-foreground: 0 0% 98%;
    --border: 240 3.7% 15.9%;
    --input: 240 3.7% 15.9%;
    --ring: 217.2 91.2% 59.8%;
  }
  body { font-family: 'Pretendard Variable', sans-serif; background: hsl(var(--background)); color: hsl(var(--foreground)); }
  input[type="text"], input[type="number"], select {
    background: hsl(var(--background));
    color: hsl(var(--foreground));
    border: 1px solid hsl(var(--border));
  }
  input:focus, select:focus {
    outline: none;
    box-shadow: 0 0 0 2px hsl(var(--ring) / 0.3);
    border-color: hsl(var(--ring));
  }
  .badge-change { font-size: 10px; padding: 1px 6px; border-radius: 9999px; font-weight: 600; }
  .badge-up { background: #fef2f2; color: #dc2626; }
  .badge-down { background: #f0fdf4; color: #16a34a; }
  .badge-new { background: #eff6ff; color: #2563eb; }
  .dark .badge-up { background: #450a0a; color: #fca5a5; }
  .dark .badge-down { background: #052e16; color: #86efac; }
  .dark .badge-new { background: #172554; color: #93c5fd; }
  @media print {
    .no-print { display: none !important; }
    body { background: white; color: black; }
  }
  .tab-btn { transition: all 0.15s; }
  .tab-btn.active { background: hsl(var(--primary)); color: hsl(var(--primary-foreground)); }
</style>
</head>
<body class="min-h-screen pb-12">

<!-- Header -->
<header class="bg-gradient-to-r from-blue-600 to-blue-700 dark:from-blue-800 dark:to-blue-900 text-white no-print">
  <div class="max-w-4xl mx-auto px-4 py-6 flex items-center justify-between">
    <div class="flex items-center gap-3">
      <img src="logo.png" alt="ì—˜ë¹„ì¦ˆ íŒŒíŠ¸ë„ˆìŠ¤" class="w-10 h-10 rounded-lg bg-white/10 p-1 object-contain">
      <div>
        <h1 class="text-2xl font-bold tracking-tight">ğŸ’¼ 4ëŒ€ë³´í—˜ëšë”±</h1>
        <p class="text-blue-100 text-sm mt-1">ì†Œìƒê³µì¸ì„ ìœ„í•œ 4ëŒ€ë³´í—˜ë£Œ ê³„ì‚°ê¸° Â· 2026ë…„ í™•ì • ìš”ìœ¨</p>
      </div>
    </div>
    <button onclick="toggleDark()" class="p-2 rounded-lg bg-white/10 hover:bg-white/20 transition" title="ë‹¤í¬ëª¨ë“œ í† ê¸€">
      <span id="darkIcon">ğŸŒ™</span>
    </button>
  </div>
</header>

<div class="max-w-4xl mx-auto px-4 mt-6">

  <!-- ìš”ìœ¨ ë³€ê²½ ë°°ë„ˆ -->
  <div class="rounded-xl border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-950/50 p-4 mb-6 no-print">
    <div class="flex items-start gap-3">
      <span class="text-xl">ğŸ“¢</span>
      <div class="text-sm">
        <p class="font-semibold text-amber-900 dark:text-amber-200">2026ë…„ í™•ì • ìš”ìœ¨ ë°˜ì˜</p>
        <div class="mt-2 flex flex-wrap gap-2 text-xs">
          <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-red-100 dark:bg-red-900/40 text-red-700 dark:text-red-300">êµ­ë¯¼ì—°ê¸ˆ 9% â†’ 9.5% <span class="badge-change badge-up">+0.5%p</span></span>
          <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300">ê±´ê°•ë³´í—˜ 7.09% â†’ 7.19%</span>
          <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300">ì¥ê¸°ìš”ì–‘ 12.95% â†’ 13.14%</span>
          <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300">ê³ ìš©ë³´í—˜ 1.8% ë™ê²°</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Tabs -->
  <div class="flex bg-muted rounded-xl p-1 mb-6 no-print gap-1">
    <button class="tab-btn active flex-1 py-2.5 text-sm font-semibold rounded-lg" onclick="switchTab('calc',this)">ğŸ§® ë³´í—˜ë£Œ ê³„ì‚°</button>
    <button class="tab-btn flex-1 py-2.5 text-sm font-semibold rounded-lg text-muted-foreground hover:text-foreground" onclick="switchTab('multi',this)">ğŸ‘¥ ë‹¤ì¤‘ ì§ì›</button>
    <button class="tab-btn flex-1 py-2.5 text-sm font-semibold rounded-lg text-muted-foreground hover:text-foreground" onclick="switchTab('dururi',this)">ğŸŒˆ ë‘ë£¨ëˆ„ë¦¬</button>
    <button class="tab-btn flex-1 py-2.5 text-sm font-semibold rounded-lg text-muted-foreground hover:text-foreground" onclick="switchTab('settings',this)">âš™ï¸ ìš”ìœ¨</button>
  </div>

  <!-- ==================== ë³´í—˜ë£Œ ê³„ì‚° íƒ­ ==================== -->
  <div id="tab-calc">
    <div class="rounded-xl border border-border bg-card shadow-sm p-6 mb-4">
      <h2 class="text-base font-bold mb-5 flex items-center gap-2">ğŸ‘¤ ê·¼ë¡œì ì •ë³´</h2>

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <div>
          <label class="block text-xs font-semibold text-muted-foreground mb-1.5">ì›” ì´ê¸‰ì—¬ (ì›)</label>
          <input type="text" id="salary" placeholder="3,000,000" oninput="formatNumber(this); autoCalc()" class="w-full px-3.5 py-2.5 rounded-lg text-sm">
        </div>
        <div>
          <label class="block text-xs font-semibold text-muted-foreground mb-1.5">ì‚¬ì—…ì¥ ê·œëª¨</label>
          <select id="companySize" onchange="autoCalc()" class="w-full px-3.5 py-2.5 rounded-lg text-sm">
            <option value="under10">10ì¸ ë¯¸ë§Œ</option>
            <option value="under50">10~50ì¸ ë¯¸ë§Œ</option>
            <option value="under150">50~150ì¸ ë¯¸ë§Œ</option>
            <option value="under1000">150~1000ì¸ ë¯¸ë§Œ</option>
            <option value="over1000">1000ì¸ ì´ìƒ</option>
          </select>
        </div>
      </div>

      <!-- ë¹„ê³¼ì„¸ ì†Œë“ -->
      <details class="mt-4 group">
        <summary class="text-xs font-semibold text-muted-foreground cursor-pointer flex items-center gap-1 hover:text-foreground transition">
          <span class="group-open:rotate-90 transition-transform">â–¶</span> ë¹„ê³¼ì„¸ ì†Œë“ ì„¤ì • (ì„ íƒ)
        </summary>
        <div class="mt-3 grid grid-cols-1 sm:grid-cols-3 gap-3 p-3 rounded-lg bg-muted/50">
          <div>
            <label class="block text-xs text-muted-foreground mb-1">ì‹ëŒ€ (ì›” ìµœëŒ€ 20ë§Œ)</label>
            <input type="text" id="taxfree_meal" placeholder="200,000" value="200,000" oninput="formatNumber(this); autoCalc()" class="w-full px-3 py-2 rounded-lg text-sm">
          </div>
          <div>
            <label class="block text-xs text-muted-foreground mb-1">ìê°€ìš´ì „ë³´ì¡°ê¸ˆ (ì›” ìµœëŒ€ 20ë§Œ)</label>
            <input type="text" id="taxfree_car" placeholder="0" oninput="formatNumber(this); autoCalc()" class="w-full px-3 py-2 rounded-lg text-sm">
          </div>
          <div>
            <label class="block text-xs text-muted-foreground mb-1">ê¸°íƒ€ ë¹„ê³¼ì„¸</label>
            <input type="text" id="taxfree_etc" placeholder="0" oninput="formatNumber(this); autoCalc()" class="w-full px-3 py-2 rounded-lg text-sm">
          </div>
        </div>
      </details>

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4">
        <div>
          <label class="block text-xs font-semibold text-muted-foreground mb-1.5">ì—…ì¢… (ì‚°ì¬ë³´í—˜)</label>
          <select id="industry" onchange="autoCalc()" class="w-full px-3.5 py-2.5 rounded-lg text-sm">
            <option value="0.70">ê¸ˆìœµÂ·ë³´í—˜ì—… (0.70%)</option>
            <option value="0.80">êµìœ¡ì„œë¹„ìŠ¤ì—… (0.80%)</option>
            <option value="0.90">ë„ì†Œë§¤Â·ìŒì‹ìˆ™ë°•ì—… (0.90%)</option>
            <option value="0.90">ì¶œíŒÂ·ì˜ìƒÂ·ì •ë³´ì„œë¹„ìŠ¤ì—… (0.90%)</option>
            <option value="1.00">ë³´ê±´Â·ì‚¬íšŒë³µì§€ (1.00%)</option>
            <option value="1.00">ì „ë¬¸Â·ê³¼í•™Â·ê¸°ìˆ ì„œë¹„ìŠ¤ì—… (1.00%)</option>
            <option value="1.10" selected>ì‚¬ë¬´ì§ (1.10%)</option>
            <option value="1.20">ë¶€ë™ì‚°Â·ì„ëŒ€ì—… (1.20%)</option>
            <option value="1.40">ì œì¡°ì—…-ì¼ë°˜ (1.40%)</option>
            <option value="1.50">ë†ë¦¼ì–´ì—… (1.50%)</option>
            <option value="1.80">ê±´ì„¤ì—…-ì¼ë°˜ (1.80%)</option>
            <option value="1.90">ìˆ˜ë¦¬Â·ê¸°íƒ€ì„œë¹„ìŠ¤ì—… (1.90%)</option>
            <option value="2.20">ìš´ìˆ˜Â·ì°½ê³ ì—… (2.20%)</option>
            <option value="2.80">ê´‘ì—… (2.80%)</option>
            <option value="3.50">ê±´ì„¤ì—…-íŠ¹ìˆ˜ (3.50%)</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-semibold text-muted-foreground mb-1.5">ë¶€ì–‘ê°€ì¡± ìˆ˜ (ì†Œë“ì„¸ ê³„ì‚°ìš©)</label>
          <select id="dependents" onchange="autoCalc()" class="w-full px-3.5 py-2.5 rounded-lg text-sm">
            <option value="1">ë³¸ì¸ (1ì¸)</option>
            <option value="2">2ì¸</option>
            <option value="3">3ì¸</option>
            <option value="4">4ì¸</option>
            <option value="5">5ì¸ ì´ìƒ</option>
          </select>
        </div>
      </div>

      <button class="mt-5 w-full py-3 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-semibold text-sm transition no-print" onclick="calculate()">ê³„ì‚°í•˜ê¸°</button>
    </div>

    <!-- Results -->
    <div id="results" style="display:none">
      <div id="resultCapture">
        <!-- ìš”ì•½ -->
        <div class="grid grid-cols-2 sm:grid-cols-4 gap-3 mb-4">
          <div class="rounded-xl border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-950/40 p-4 text-center">
            <div class="text-xs text-muted-foreground mb-1">ì‚¬ì—…ì£¼ ë¶€ë‹´</div>
            <div class="text-lg font-bold text-blue-600 dark:text-blue-400" id="sumEmployer">0ì›</div>
          </div>
          <div class="rounded-xl border border-emerald-200 dark:border-emerald-800 bg-emerald-50 dark:bg-emerald-950/40 p-4 text-center">
            <div class="text-xs text-muted-foreground mb-1">ê·¼ë¡œì ë¶€ë‹´</div>
            <div class="text-lg font-bold text-emerald-600 dark:text-emerald-400" id="sumEmployee">0ì›</div>
          </div>
          <div class="rounded-xl border border-purple-200 dark:border-purple-800 bg-purple-50 dark:bg-purple-950/40 p-4 text-center">
            <div class="text-xs text-muted-foreground mb-1">ì˜ˆìƒ ì†Œë“ì„¸</div>
            <div class="text-lg font-bold text-purple-600 dark:text-purple-400" id="sumTax">0ì›</div>
          </div>
          <div class="rounded-xl border border-orange-200 dark:border-orange-800 bg-orange-50 dark:bg-orange-950/40 p-4 text-center">
            <div class="text-xs text-muted-foreground mb-1">ì›” ì‹¤ìˆ˜ë ¹ì•¡</div>
            <div class="text-lg font-bold text-orange-600 dark:text-orange-400" id="sumNetPay">0ì›</div>
          </div>
        </div>

        <!-- ìƒì„¸ í…Œì´ë¸” -->
        <div class="rounded-xl border border-border bg-card shadow-sm overflow-hidden mb-4">
          <div class="px-6 py-4 border-b border-border flex justify-between items-center">
            <h2 class="font-bold text-base">ğŸ“Š ìƒì„¸ ë‚´ì—­</h2>
            <span class="text-xs text-muted-foreground" id="taxableNote"></span>
          </div>
          <div class="overflow-x-auto">
            <table class="w-full text-sm">
              <thead>
                <tr class="border-b border-border bg-muted/50">
                  <th class="text-left px-6 py-3 text-xs font-semibold text-muted-foreground">í•­ëª©</th>
                  <th class="text-right px-6 py-3 text-xs font-semibold text-muted-foreground">ìš”ìœ¨</th>
                  <th class="text-right px-6 py-3 text-xs font-semibold text-muted-foreground">ì‚¬ì—…ì£¼</th>
                  <th class="text-right px-6 py-3 text-xs font-semibold text-muted-foreground">ê·¼ë¡œì</th>
                </tr>
              </thead>
              <tbody id="resultBody"></tbody>
              <tfoot>
                <tr class="border-t-2 border-border bg-muted/30 font-bold">
                  <td class="px-6 py-3" colspan="2">í•©ê³„</td>
                  <td class="text-right px-6 py-3" id="footEmployer"></td>
                  <td class="text-right px-6 py-3" id="footEmployee"></td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>

        <!-- ì—°ê°„/ì‹¤ìˆ˜ë ¹ -->
        <div class="rounded-xl border border-border bg-card shadow-sm p-6 mb-4">
          <h2 class="font-bold text-base mb-4">ğŸ’° ì—°ê°„ í•©ê³„ & ì‹¤ìˆ˜ë ¹</h2>
          <div id="annualInfo" class="text-sm space-y-1.5 text-muted-foreground"></div>
        </div>
      </div>

      <!-- ë²„íŠ¼ -->
      <div class="flex gap-2 no-print mb-6">
        <button onclick="window.print()" class="flex-1 py-2.5 rounded-lg border border-border text-sm font-semibold hover:bg-muted transition">ğŸ–¨ï¸ ì¸ì‡„</button>
        <button onclick="saveAsImage()" class="flex-1 py-2.5 rounded-lg border border-border text-sm font-semibold hover:bg-muted transition">ğŸ“¸ ì´ë¯¸ì§€ ì €ì¥</button>
      </div>
    </div>
  </div>

  <!-- ==================== ë‹¤ì¤‘ ì§ì› íƒ­ ==================== -->
  <div id="tab-multi" style="display:none">
    <div class="rounded-xl border border-border bg-card shadow-sm p-6 mb-4">
      <div class="flex items-center justify-between mb-5">
        <h2 class="font-bold text-base">ğŸ‘¥ ë‹¤ì¤‘ ì§ì› ë³´í—˜ë£Œ ê³„ì‚°</h2>
        <button onclick="addEmployee()" class="px-3 py-1.5 rounded-lg bg-blue-600 text-white text-xs font-semibold hover:bg-blue-700 transition">+ ì§ì› ì¶”ê°€</button>
      </div>

      <div class="mb-4 grid grid-cols-1 sm:grid-cols-2 gap-3">
        <div>
          <label class="block text-xs font-semibold text-muted-foreground mb-1.5">ì‚¬ì—…ì¥ ê·œëª¨</label>
          <select id="multiCompanySize" class="w-full px-3 py-2 rounded-lg text-sm">
            <option value="under10">10ì¸ ë¯¸ë§Œ</option>
            <option value="under50">10~50ì¸ ë¯¸ë§Œ</option>
            <option value="under150">50~150ì¸ ë¯¸ë§Œ</option>
            <option value="under1000">150~1000ì¸ ë¯¸ë§Œ</option>
            <option value="over1000">1000ì¸ ì´ìƒ</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-semibold text-muted-foreground mb-1.5">ì—…ì¢… (ì‚°ì¬ë³´í—˜)</label>
          <select id="multiIndustry" class="w-full px-3 py-2 rounded-lg text-sm">
            <option value="1.10">ì‚¬ë¬´ì§ (1.10%)</option>
            <option value="0.90">ë„ì†Œë§¤Â·ìŒì‹ìˆ™ë°•ì—… (0.90%)</option>
            <option value="1.40">ì œì¡°ì—…-ì¼ë°˜ (1.40%)</option>
            <option value="1.80">ê±´ì„¤ì—…-ì¼ë°˜ (1.80%)</option>
          </select>
        </div>
      </div>

      <div id="employeeList" class="space-y-2"></div>

      <button onclick="calcMulti()" class="mt-4 w-full py-3 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-semibold text-sm transition">ì „ì²´ ê³„ì‚°</button>
    </div>

    <div id="multiResults" style="display:none">
      <div id="multiCapture">
        <div class="rounded-xl border border-border bg-card shadow-sm overflow-hidden mb-4">
          <div class="px-6 py-4 border-b border-border">
            <h2 class="font-bold text-base">ğŸ“Š ì „ì²´ ì§ì› ë³´í—˜ë£Œ</h2>
          </div>
          <div class="overflow-x-auto">
            <table class="w-full text-sm">
              <thead>
                <tr class="border-b border-border bg-muted/50">
                  <th class="text-left px-4 py-3 text-xs font-semibold text-muted-foreground">ì´ë¦„</th>
                  <th class="text-right px-4 py-3 text-xs font-semibold text-muted-foreground">ê¸‰ì—¬</th>
                  <th class="text-right px-4 py-3 text-xs font-semibold text-muted-foreground">ì‚¬ì—…ì£¼</th>
                  <th class="text-right px-4 py-3 text-xs font-semibold text-muted-foreground">ê·¼ë¡œì</th>
                  <th class="text-right px-4 py-3 text-xs font-semibold text-muted-foreground">í•©ê³„</th>
                </tr>
              </thead>
              <tbody id="multiBody"></tbody>
              <tfoot>
                <tr class="border-t-2 border-border bg-muted/30 font-bold">
                  <td class="px-4 py-3">í•©ê³„</td>
                  <td class="text-right px-4 py-3" id="multiTotalSalary"></td>
                  <td class="text-right px-4 py-3" id="multiTotalEmployer"></td>
                  <td class="text-right px-4 py-3" id="multiTotalEmployee"></td>
                  <td class="text-right px-4 py-3" id="multiTotalAll"></td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>
      </div>
      <div class="flex gap-2 no-print mb-6">
        <button onclick="window.print()" class="flex-1 py-2.5 rounded-lg border border-border text-sm font-semibold hover:bg-muted transition">ğŸ–¨ï¸ ì¸ì‡„</button>
        <button onclick="saveMultiImage()" class="flex-1 py-2.5 rounded-lg border border-border text-sm font-semibold hover:bg-muted transition">ğŸ“¸ ì´ë¯¸ì§€ ì €ì¥</button>
      </div>
    </div>
  </div>

  <!-- ==================== ë‘ë£¨ëˆ„ë¦¬ íƒ­ ==================== -->
  <div id="tab-dururi" style="display:none">
    <div class="rounded-xl border border-border bg-card shadow-sm p-6 mb-4">
      <h2 class="font-bold text-base mb-2 flex items-center gap-2">ğŸŒˆ ë‘ë£¨ëˆ„ë¦¬ ì§€ì›ê¸ˆ í™•ì¸</h2>
      <p class="text-sm text-muted-foreground mb-5">ì†Œê·œëª¨ ì‚¬ì—…ì¥ì˜ ì‚¬ì—…ì£¼Â·ê·¼ë¡œì ì‚¬íšŒë³´í—˜ë£Œ ì¼ë¶€ë¥¼ êµ­ê°€ì—ì„œ ì§€ì›í•©ë‹ˆë‹¤.</p>

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <div>
          <label class="block text-xs font-semibold text-muted-foreground mb-1.5">ê·¼ë¡œì ìˆ˜</label>
          <input type="number" id="dururiWorkers" value="5" class="w-full px-3.5 py-2.5 rounded-lg text-sm">
        </div>
        <div>
          <label class="block text-xs font-semibold text-muted-foreground mb-1.5">ê·¼ë¡œì ì›” ê¸‰ì—¬ (ì›)</label>
          <input type="text" id="dururiSalary" placeholder="2,700,000" oninput="formatNumber(this)" class="w-full px-3.5 py-2.5 rounded-lg text-sm">
        </div>
      </div>

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4">
        <div>
          <label class="block text-xs font-semibold text-muted-foreground mb-1.5">ê°€ì… ìœ í˜•</label>
          <select id="dururiNew" class="w-full px-3.5 py-2.5 rounded-lg text-sm">
            <option value="new">ì‹ ê·œê°€ì… (6ê°œì›” ì´ìƒ ë¯¸ê°€ì…)</option>
            <option value="existing">ê¸°ì¡´ê°€ì…ì</option>
          </select>
        </div>
        <div>
          <label class="block text-xs font-semibold text-muted-foreground mb-1.5">ì§€ì› ê²½ê³¼ ê¸°ê°„</label>
          <select id="dururiPeriod" class="w-full px-3.5 py-2.5 rounded-lg text-sm">
            <option value="0">ì‹œì‘ ì „ / ë¯¸ì‹ ì²­</option>
            <option value="12">12ê°œì›” ë¯¸ë§Œ</option>
            <option value="24">12~24ê°œì›”</option>
            <option value="36">24~36ê°œì›”</option>
            <option value="over">36ê°œì›” ì´ˆê³¼ (ì¢…ë£Œ)</option>
          </select>
        </div>
      </div>

      <button class="mt-5 w-full py-3 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-semibold text-sm transition" onclick="checkDururi()">ì§€ì› ëŒ€ìƒ í™•ì¸</button>
      <div id="dururiResult" class="mt-4"></div>
    </div>

    <div class="rounded-xl border border-border bg-card shadow-sm p-6">
      <h2 class="font-bold text-base mb-3">ğŸ“‹ ë‘ë£¨ëˆ„ë¦¬ ì§€ì› ì¡°ê±´</h2>
      <ul class="text-sm text-muted-foreground space-y-2 list-disc pl-5">
        <li><strong>ì‚¬ì—…ì¥ ê·œëª¨:</strong> ê·¼ë¡œì 10ì¸ ë¯¸ë§Œ</li>
        <li><strong>ê·¼ë¡œì ìš”ê±´:</strong> ì›”í‰ê·  ë³´ìˆ˜ 270ë§Œì› ë¯¸ë§Œ</li>
        <li><strong>ì‹ ê·œê°€ì…ì:</strong> êµ­ë¯¼ì—°ê¸ˆÂ·ê³ ìš©ë³´í—˜ë£Œì˜ 80% ì§€ì›</li>
        <li><strong>ê¸°ì¡´ê°€ì…ì:</strong> ì§€ì› ì¢…ë£Œ (2022ë…„ ì´í›„ ì‹ ê·œë§Œ ì§€ì›)</li>
        <li><strong>ì§€ì› ê¸°ê°„:</strong> ìµœëŒ€ 36ê°œì›”</li>
        <li><strong>ì§€ì› ë³´í—˜:</strong> êµ­ë¯¼ì—°ê¸ˆ + ê³ ìš©ë³´í—˜ (ê±´ê°•ë³´í—˜Â·ì‚°ì¬ë³´í—˜ ì œì™¸)</li>
      </ul>
    </div>
  </div>

  <!-- ==================== ìš”ìœ¨ ì„¤ì • íƒ­ ==================== -->
  <div id="tab-settings" style="display:none">
    <div class="rounded-xl border border-border bg-card shadow-sm p-6">
      <h2 class="font-bold text-base mb-1">âš™ï¸ 2026ë…„ 4ëŒ€ë³´í—˜ ìš”ìœ¨</h2>
      <p class="text-xs text-muted-foreground mb-5">ìˆ˜ì • í›„ ì €ì¥ ì‹œ ë¡œì»¬ ë¸Œë¼ìš°ì €ì— ë³´ê´€ë©ë‹ˆë‹¤.</p>

      <div class="space-y-3">
        <div class="grid grid-cols-3 gap-2 items-center p-3 rounded-lg bg-muted/50">
          <span class="text-sm font-medium">êµ­ë¯¼ì—°ê¸ˆ <span class="badge-change badge-up ml-1">â†‘</span></span>
          <input type="text" id="r_pe" value="4.75" class="px-2 py-1.5 rounded-lg text-sm text-center" placeholder="ì‚¬ì—…ì£¼%">
          <input type="text" id="r_pw" value="4.75" class="px-2 py-1.5 rounded-lg text-sm text-center" placeholder="ê·¼ë¡œì%">
        </div>
        <div class="grid grid-cols-3 gap-2 items-center p-3 rounded-lg bg-muted/50">
          <span class="text-sm font-medium">ê±´ê°•ë³´í—˜</span>
          <input type="text" id="r_he" value="3.595" class="px-2 py-1.5 rounded-lg text-sm text-center">
          <input type="text" id="r_hw" value="3.595" class="px-2 py-1.5 rounded-lg text-sm text-center">
        </div>
        <div class="grid grid-cols-3 gap-2 items-center p-3 rounded-lg bg-muted/50">
          <span class="text-sm font-medium">ì¥ê¸°ìš”ì–‘ <span class="text-xs text-muted-foreground">(ê±´ë³´Ã—%)</span></span>
          <input type="text" id="r_lt" value="13.14" class="px-2 py-1.5 rounded-lg text-sm text-center">
          <span class="text-xs text-muted-foreground text-center">ë³´í—˜ë£Œìœ¨ 0.9448%</span>
        </div>
        <div class="grid grid-cols-3 gap-2 items-center p-3 rounded-lg bg-muted/50">
          <span class="text-sm font-medium">ê³ ìš©ë³´í—˜ (ì‹¤ì—…ê¸‰ì—¬)</span>
          <input type="text" id="r_ee" value="0.9" class="px-2 py-1.5 rounded-lg text-sm text-center">
          <input type="text" id="r_ew" value="0.9" class="px-2 py-1.5 rounded-lg text-sm text-center">
        </div>
      </div>

      <h3 class="text-sm font-semibold mt-6 mb-3">ğŸ¢ ê³ ìš©ì•ˆì •Â·ì§ì—…ëŠ¥ë ¥ê°œë°œ (ì‚¬ì—…ì£¼ë§Œ)</h3>
      <div class="space-y-2">
        <div class="grid grid-cols-2 gap-2 items-center p-3 rounded-lg bg-muted/50">
          <span class="text-sm">150ì¸ ë¯¸ë§Œ</span>
          <input type="text" id="r_d1" value="0.25" class="px-2 py-1.5 rounded-lg text-sm text-center">
        </div>
        <div class="grid grid-cols-2 gap-2 items-center p-3 rounded-lg bg-muted/50">
          <span class="text-sm">150ì¸ ì´ìƒ (ìš°ì„ ì§€ì›)</span>
          <input type="text" id="r_d2" value="0.45" class="px-2 py-1.5 rounded-lg text-sm text-center">
        </div>
        <div class="grid grid-cols-2 gap-2 items-center p-3 rounded-lg bg-muted/50">
          <span class="text-sm">150~1000ì¸</span>
          <input type="text" id="r_d3" value="0.65" class="px-2 py-1.5 rounded-lg text-sm text-center">
        </div>
        <div class="grid grid-cols-2 gap-2 items-center p-3 rounded-lg bg-muted/50">
          <span class="text-sm">1000ì¸ ì´ìƒ</span>
          <input type="text" id="r_d4" value="0.85" class="px-2 py-1.5 rounded-lg text-sm text-center">
        </div>
      </div>

      <!-- ìš”ìœ¨ ë³€ê²½ ì´ë ¥ -->
      <h3 class="text-sm font-semibold mt-6 mb-3">ğŸ“ˆ 2025 â†’ 2026 ìš”ìœ¨ ë³€ê²½ ì´ë ¥</h3>
      <div class="overflow-x-auto">
        <table class="w-full text-xs">
          <thead><tr class="border-b border-border">
            <th class="text-left py-2 px-3 text-muted-foreground">í•­ëª©</th>
            <th class="text-right py-2 px-3 text-muted-foreground">2025</th>
            <th class="text-right py-2 px-3 text-muted-foreground">2026</th>
            <th class="text-right py-2 px-3 text-muted-foreground">ë³€ë™</th>
          </tr></thead>
          <tbody class="text-muted-foreground">
            <tr class="border-b border-border/50"><td class="py-2 px-3">êµ­ë¯¼ì—°ê¸ˆ</td><td class="text-right py-2 px-3">9.0%</td><td class="text-right py-2 px-3 font-semibold text-foreground">9.5%</td><td class="text-right py-2 px-3"><span class="badge-change badge-up">+0.5%p</span></td></tr>
            <tr class="border-b border-border/50"><td class="py-2 px-3">ê±´ê°•ë³´í—˜</td><td class="text-right py-2 px-3">7.09%</td><td class="text-right py-2 px-3 font-semibold text-foreground">7.19%</td><td class="text-right py-2 px-3"><span class="badge-change badge-up">+0.1%p</span></td></tr>
            <tr class="border-b border-border/50"><td class="py-2 px-3">ì¥ê¸°ìš”ì–‘ (ê±´ë³´ëŒ€ë¹„)</td><td class="text-right py-2 px-3">12.95%</td><td class="text-right py-2 px-3 font-semibold text-foreground">13.14%</td><td class="text-right py-2 px-3"><span class="badge-change badge-up">+0.19%p</span></td></tr>
            <tr class="border-b border-border/50"><td class="py-2 px-3">ê³ ìš©ë³´í—˜(ì‹¤ì—…)</td><td class="text-right py-2 px-3">1.8%</td><td class="text-right py-2 px-3 font-semibold text-foreground">1.8%</td><td class="text-right py-2 px-3">-</td></tr>
            <tr><td class="py-2 px-3">ì—°ê¸ˆ ê¸°ì¤€ì†Œë“ ìƒí•œ</td><td class="text-right py-2 px-3">590ë§Œ</td><td class="text-right py-2 px-3 font-semibold text-foreground">617ë§Œ</td><td class="text-right py-2 px-3"><span class="badge-change badge-up">+27ë§Œ</span></td></tr>
          </tbody>
        </table>
      </div>

      <div class="flex gap-2 mt-6">
        <button onclick="saveRates()" class="flex-1 py-2.5 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-semibold text-sm transition">ğŸ’¾ ì €ì¥</button>
        <button onclick="resetRates()" class="flex-1 py-2.5 rounded-lg border border-border text-sm font-semibold hover:bg-muted transition">â†©ï¸ ê¸°ë³¸ê°’</button>
      </div>

      <div class="mt-5 p-3 rounded-lg bg-muted/50 text-xs text-muted-foreground">
        <strong>ğŸ“Œ ê³µì‹ ì¶œì²˜:</strong>
        <a href="https://www.nps.or.kr" target="_blank" class="text-blue-600 dark:text-blue-400 hover:underline">êµ­ë¯¼ì—°ê¸ˆê³µë‹¨</a> Â·
        <a href="https://www.nhis.or.kr" target="_blank" class="text-blue-600 dark:text-blue-400 hover:underline">ê±´ê°•ë³´í—˜ê³µë‹¨</a> Â·
        <a href="https://www.ei.go.kr" target="_blank" class="text-blue-600 dark:text-blue-400 hover:underline">ê³ ìš©ë³´í—˜</a> Â·
        <a href="https://www.kcomwel.or.kr" target="_blank" class="text-blue-600 dark:text-blue-400 hover:underline">ê·¼ë¡œë³µì§€ê³µë‹¨</a> Â·
        <a href="https://www.4insure.or.kr" target="_blank" class="text-blue-600 dark:text-blue-400 hover:underline">4ëŒ€ì‚¬íšŒë³´í—˜ ì •ë³´ì—°ê³„ì„¼í„°</a>
      </div>
    </div>
  </div>
</div>

<!-- Footer -->
<footer class="max-w-4xl mx-auto px-4 mt-8 pb-8">
  <div class="rounded-xl border border-border bg-card shadow-sm p-5 text-xs text-muted-foreground">
    <p class="font-semibold text-foreground mb-2">âš ï¸ ë©´ì±…ì¡°í•­</p>
    <ul class="space-y-1 list-disc pl-4">
      <li>ë³¸ ê³„ì‚°ê¸°ëŠ” ì°¸ê³ ìš©ì´ë©°, ì‹¤ì œ ë³´í—˜ë£ŒëŠ” ê° ê³µë‹¨ì˜ ê³ ì§€ ê¸ˆì•¡ê³¼ ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
      <li>ê·¼ë¡œì†Œë“ì„¸ëŠ” ê°„ì´ì„¸ì•¡í‘œ ê¸°ë°˜ ì¶”ì •ì¹˜ì´ë©°, ì •í™•í•œ ì„¸ì•¡ì€ êµ­ì„¸ì²­ í™ˆíƒìŠ¤ë¥¼ ì´ìš©í•˜ì„¸ìš”.</li>
      <li>ì› ë‹¨ìœ„ ì ˆì‚¬/ë°˜ì˜¬ë¦¼ ë°©ì‹ì€ ê° ê³µë‹¨ ê¸°ì¤€ê³¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
      <li>2026ë…„ í™•ì • ìš”ìœ¨ ê¸°ì¤€ì´ë©°, ë³€ê²½ ì‹œ ìš”ìœ¨ ì„¤ì •ì—ì„œ ìˆ˜ì •í•˜ì„¸ìš”.</li>
    </ul>
    <div class="mt-4 pt-4 border-t border-border flex flex-col items-center gap-2">
      <div class="flex items-center gap-2">
        <img src="logo.png" alt="ì—˜ë¹„ì¦ˆ íŒŒíŠ¸ë„ˆìŠ¤" class="w-5 h-5 object-contain opacity-60">
        <span class="font-medium text-foreground">ì—˜ë¹„ì¦ˆ íŒŒíŠ¸ë„ˆìŠ¤</span>
      </div>
      <p class="text-muted-foreground">ì´ìƒìˆ˜ ëŒ€í‘œ Â· 010-3709-5785 Â· <a href="mailto:sangsu0916@naver.com" class="underline hover:text-foreground">sangsu0916@naver.com</a></p>
      <p class="text-muted-foreground/60">ì¶œì²˜: êµ­ë¯¼ì—°ê¸ˆê³µë‹¨ Â· êµ­ë¯¼ê±´ê°•ë³´í—˜ê³µë‹¨ Â· ê³ ìš©ë…¸ë™ë¶€ Â· ê·¼ë¡œë³µì§€ê³µë‹¨</p>
      <p class="text-muted-foreground/60">Â© 2026 4ëŒ€ë³´í—˜ëšë”± Â· ì—˜ë¹„ì¦ˆ íŒŒíŠ¸ë„ˆìŠ¤</p>
    </div>
  </div>
</footer>

<script>
// ===== Rates =====
const DR = {
  pension: { e: 4.75, w: 4.75 },
  health: { e: 3.595, w: 3.595 },
  longterm: 13.14,
  employ: { e: 0.9, w: 0.9 },
  dev: { d1: 0.25, d2: 0.45, d3: 0.65, d4: 0.85 }
};
let R = JSON.parse(JSON.stringify(DR));

function loadRates() {
  const s = localStorage.getItem('4insure_rates_v2');
  if (s) R = JSON.parse(s);
  document.getElementById('r_pe').value = R.pension.e;
  document.getElementById('r_pw').value = R.pension.w;
  document.getElementById('r_he').value = R.health.e;
  document.getElementById('r_hw').value = R.health.w;
  document.getElementById('r_lt').value = R.longterm;
  document.getElementById('r_ee').value = R.employ.e;
  document.getElementById('r_ew').value = R.employ.w;
  document.getElementById('r_d1').value = R.dev.d1;
  document.getElementById('r_d2').value = R.dev.d2;
  document.getElementById('r_d3').value = R.dev.d3;
  document.getElementById('r_d4').value = R.dev.d4;
}
function saveRates() {
  R.pension.e = parseFloat(document.getElementById('r_pe').value)||4.75;
  R.pension.w = parseFloat(document.getElementById('r_pw').value)||4.75;
  R.health.e = parseFloat(document.getElementById('r_he').value)||3.595;
  R.health.w = parseFloat(document.getElementById('r_hw').value)||3.595;
  R.longterm = parseFloat(document.getElementById('r_lt').value)||13.14;
  R.employ.e = parseFloat(document.getElementById('r_ee').value)||0.9;
  R.employ.w = parseFloat(document.getElementById('r_ew').value)||0.9;
  R.dev.d1 = parseFloat(document.getElementById('r_d1').value)||0.25;
  R.dev.d2 = parseFloat(document.getElementById('r_d2').value)||0.45;
  R.dev.d3 = parseFloat(document.getElementById('r_d3').value)||0.65;
  R.dev.d4 = parseFloat(document.getElementById('r_d4').value)||0.85;
  localStorage.setItem('4insure_rates_v2', JSON.stringify(R));
  alert('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
}
function resetRates() {
  if (!confirm('ê¸°ë³¸ê°’ìœ¼ë¡œ ë³µì›?')) return;
  R = JSON.parse(JSON.stringify(DR));
  localStorage.removeItem('4insure_rates_v2');
  loadRates();
}

// ===== Utils =====
function fmt(n) { return Math.round(n).toLocaleString('ko-KR') + 'ì›'; }
function pn(s) { return parseInt(String(s).replace(/[^\d]/g,''))||0; }
function formatNumber(el) { let v=el.value.replace(/[^\d]/g,''); el.value=v.replace(/\B(?=(\d{3})+(?!\d))/g,','); }
function getDevRate(sz) {
  if (sz==='under10'||sz==='under50'||sz==='under150') return R.dev.d1;
  if (sz==='under1000') return R.dev.d3;
  return R.dev.d4;
}

// ===== ê·¼ë¡œì†Œë“ì„¸ ê°„ì´ì„¸ì•¡ ì¶”ì • =====
function estimateIncomeTax(monthlySalary, dependents) {
  // ê³¼ì„¸ ëŒ€ìƒ ê·¼ë¡œì†Œë“ (ë¹„ê³¼ì„¸ ì œì™¸ í›„)
  const annual = monthlySalary * 12;
  // ê·¼ë¡œì†Œë“ê³µì œ
  let deduction = 0;
  if (annual <= 5000000) deduction = annual * 0.7;
  else if (annual <= 15000000) deduction = 3500000 + (annual - 5000000) * 0.4;
  else if (annual <= 45000000) deduction = 7500000 + (annual - 15000000) * 0.15;
  else if (annual <= 100000000) deduction = 12000000 + (annual - 45000000) * 0.05;
  else deduction = 14750000 + (annual - 100000000) * 0.02;

  let taxableIncome = annual - deduction;
  // ì¸ì ê³µì œ (1ì¸ 150ë§Œ)
  taxableIncome -= dependents * 1500000;
  // êµ­ë¯¼ì—°ê¸ˆ ê³µì œ (ëŒ€ëµ)
  taxableIncome -= Math.min(monthlySalary, 6170000) * (R.pension.w / 100) * 12;
  // ê±´ê°•ë³´í—˜ ê³µì œ
  taxableIncome -= monthlySalary * (R.health.w / 100) * 12;
  // ê³ ìš©ë³´í—˜ ê³µì œ
  taxableIncome -= monthlySalary * (R.employ.w / 100) * 12;
  // í‘œì¤€ì„¸ì•¡ê³µì œ 13ë§Œ
  if (taxableIncome < 0) taxableIncome = 0;

  // ì‚°ì¶œì„¸ì•¡ (ì¢…í•©ì†Œë“ì„¸ìœ¨)
  let tax = 0;
  const brackets = [
    [14000000, 0.06], [50000000, 0.15], [88000000, 0.24],
    [150000000, 0.35], [300000000, 0.38], [500000000, 0.40],
    [1000000000, 0.42], [Infinity, 0.45]
  ];
  let prev = 0;
  for (const [limit, rate] of brackets) {
    if (taxableIncome <= prev) break;
    const chunk = Math.min(taxableIncome, limit) - prev;
    tax += chunk * rate;
    prev = limit;
  }

  // í‘œì¤€ì„¸ì•¡ê³µì œ 13ë§Œì›
  tax = Math.max(0, tax - 130000);
  // ì›” í™˜ì‚°
  const monthlyTax = Math.round(tax / 12);
  // ì§€ë°©ì†Œë“ì„¸ 10%
  const localTax = Math.round(monthlyTax * 0.1);
  return { incomeTax: monthlyTax, localTax, total: monthlyTax + localTax };
}

// ===== ë³´í—˜ë£Œ ê³„ì‚° ì½”ì–´ =====
function calcInsurance(salary, companySize, industryRate) {
  const pensionBase = Math.max(390000, Math.min(salary, 6170000));
  const healthBase = salary;

  const pe = pensionBase * R.pension.e / 100;
  const pw = pensionBase * R.pension.w / 100;
  const he = healthBase * R.health.e / 100;
  const hw = healthBase * R.health.w / 100;
  const le = he * R.longterm / 100;
  const lw = hw * R.longterm / 100;
  const ee = salary * R.employ.e / 100;
  const ew = salary * R.employ.w / 100;
  const dr = getDevRate(companySize);
  const de = salary * dr / 100;
  const ae = salary * industryRate / 100;

  const totalE = pe+he+le+ee+de+ae;
  const totalW = pw+hw+lw+ew;

  return { pe,pw,he,hw,le,lw,ee,ew,de,ae,totalE,totalW,pensionBase,devRate:dr };
}

// ===== Tab =====
function switchTab(tab, btn) {
  document.querySelectorAll('.tab-btn').forEach(b=>{b.classList.remove('active');b.classList.add('text-muted-foreground');});
  btn.classList.add('active');btn.classList.remove('text-muted-foreground');
  ['calc','multi','dururi','settings'].forEach(t=>{
    document.getElementById('tab-'+t).style.display = t===tab?'':'none';
  });
}

// ===== ë‹¨ì¼ ê³„ì‚° =====
function autoCalc() {
  const s = pn(document.getElementById('salary').value);
  if (s > 0) calculate();
}

function calculate() {
  const gross = pn(document.getElementById('salary').value);
  if (!gross) return;

  const tfMeal = Math.min(pn(document.getElementById('taxfree_meal').value), 200000);
  const tfCar = Math.min(pn(document.getElementById('taxfree_car').value), 200000);
  const tfEtc = pn(document.getElementById('taxfree_etc').value);
  const taxFreeTotal = tfMeal + tfCar + tfEtc;
  const taxableSalary = Math.max(0, gross - taxFreeTotal);

  const sz = document.getElementById('companySize').value;
  const ir = parseFloat(document.getElementById('industry').value);
  const dep = parseInt(document.getElementById('dependents').value);

  const c = calcInsurance(gross, sz, ir);
  const tax = estimateIncomeTax(taxableSalary, dep);

  const netPay = gross - c.totalW - tax.total;

  document.getElementById('results').style.display = '';
  document.getElementById('sumEmployer').textContent = fmt(c.totalE);
  document.getElementById('sumEmployee').textContent = fmt(c.totalW);
  document.getElementById('sumTax').textContent = fmt(tax.total);
  document.getElementById('sumNetPay').textContent = fmt(netPay);
  document.getElementById('footEmployer').textContent = fmt(c.totalE);
  document.getElementById('footEmployee').textContent = fmt(c.totalW);
  document.getElementById('taxableNote').textContent = taxFreeTotal > 0 ? `ë¹„ê³¼ì„¸ ${fmt(taxFreeTotal)} ì œì™¸ â†’ ê³¼ì„¸ì†Œë“ ${fmt(taxableSalary)}` : '';

  const rateText = (r) => r.toFixed(2) + '%';

  document.getElementById('resultBody').innerHTML = `
    <tr class="border-b border-border/50"><td class="px-6 py-2.5">êµ­ë¯¼ì—°ê¸ˆ</td><td class="text-right px-6 py-2.5 text-muted-foreground">${rateText(R.pension.e)}/${rateText(R.pension.w)}</td><td class="text-right px-6 py-2.5 tabular-nums">${fmt(c.pe)}</td><td class="text-right px-6 py-2.5 tabular-nums">${fmt(c.pw)}</td></tr>
    <tr class="border-b border-border/50"><td class="px-6 py-2.5">ê±´ê°•ë³´í—˜</td><td class="text-right px-6 py-2.5 text-muted-foreground">${rateText(R.health.e)}/${rateText(R.health.w)}</td><td class="text-right px-6 py-2.5 tabular-nums">${fmt(c.he)}</td><td class="text-right px-6 py-2.5 tabular-nums">${fmt(c.hw)}</td></tr>
    <tr class="border-b border-border/50"><td class="px-6 py-2.5">ì¥ê¸°ìš”ì–‘ë³´í—˜ <span class="text-xs text-muted-foreground">(0.9448%)</span></td><td class="text-right px-6 py-2.5 text-muted-foreground">ê±´ë³´Ã—${R.longterm}%</td><td class="text-right px-6 py-2.5 tabular-nums">${fmt(c.le)}</td><td class="text-right px-6 py-2.5 tabular-nums">${fmt(c.lw)}</td></tr>
    <tr class="border-b border-border/50"><td class="px-6 py-2.5">ê³ ìš©ë³´í—˜ (ì‹¤ì—…ê¸‰ì—¬)</td><td class="text-right px-6 py-2.5 text-muted-foreground">${rateText(R.employ.e)}/${rateText(R.employ.w)}</td><td class="text-right px-6 py-2.5 tabular-nums">${fmt(c.ee)}</td><td class="text-right px-6 py-2.5 tabular-nums">${fmt(c.ew)}</td></tr>
    <tr class="border-b border-border/50"><td class="px-6 py-2.5">ê³ ìš©ì•ˆì •Â·ì§ëŠ¥ê°œë°œ</td><td class="text-right px-6 py-2.5 text-muted-foreground">${rateText(c.devRate)}</td><td class="text-right px-6 py-2.5 tabular-nums">${fmt(c.de)}</td><td class="text-right px-6 py-2.5 text-muted-foreground">-</td></tr>
    <tr><td class="px-6 py-2.5">ì‚°ì¬ë³´í—˜</td><td class="text-right px-6 py-2.5 text-muted-foreground">${rateText(ir)}</td><td class="text-right px-6 py-2.5 tabular-nums">${fmt(c.ae)}</td><td class="text-right px-6 py-2.5 text-muted-foreground">-</td></tr>
  `;

  const monthTotal = c.totalE + c.totalW;
  document.getElementById('annualInfo').innerHTML = `
    <p>â€¢ <strong>ì›” ì´ 4ëŒ€ë³´í—˜ë£Œ:</strong> ${fmt(monthTotal)} (ì‚¬ì—…ì£¼ ${fmt(c.totalE)} + ê·¼ë¡œì ${fmt(c.totalW)})</p>
    <p>â€¢ <strong>ì—°ê°„ ì´ 4ëŒ€ë³´í—˜ë£Œ:</strong> ${fmt(monthTotal*12)}</p>
    <p>â€¢ <strong>ì‚¬ì—…ì£¼ ì—°ê°„ ë¶€ë‹´:</strong> ${fmt(c.totalE*12)}</p>
    <hr class="my-2 border-border">
    <p>â€¢ <strong>ì˜ˆìƒ ê·¼ë¡œì†Œë“ì„¸:</strong> ${fmt(tax.incomeTax)} (ì§€ë°©ì†Œë“ì„¸ ${fmt(tax.localTax)} í¬í•¨ ì‹œ ${fmt(tax.total)})</p>
    <p>â€¢ <strong>ì›” ì‹¤ìˆ˜ë ¹ì•¡:</strong> ${fmt(netPay)} = ì´ê¸‰ì—¬ ${fmt(gross)} - ê·¼ë¡œìë¶€ë‹´ ${fmt(c.totalW)} - ì†Œë“ì„¸ ${fmt(tax.total)}</p>
    <p>â€¢ <strong>ì—°ê°„ ì‹¤ìˆ˜ë ¹ì•¡ (ì¶”ì •):</strong> ${fmt(netPay*12)}</p>
    <hr class="my-2 border-border">
    <p class="text-xs">â€¢ êµ­ë¯¼ì—°ê¸ˆ ê¸°ì¤€ì†Œë“ì›”ì•¡: ${fmt(c.pensionBase)} ${gross>6170000?'<span class="text-amber-600">(ìƒí•œ 617ë§Œì› ì ìš©)</span>':gross<390000?'<span class="text-amber-600">(í•˜í•œ 39ë§Œì› ì ìš©)</span>':''}</p>
    <p class="text-xs">â€¢ ì¥ê¸°ìš”ì–‘ë³´í—˜ë£Œìœ¨: ê±´ê°•ë³´í—˜ë£Œì˜ ${R.longterm}% (ë³´í—˜ë£Œìœ¨ 0.9448%)</p>
  `;
}

// ===== ë‹¤ì¤‘ ì§ì› =====
let employees = [{ name: 'ì§ì›1', salary: '' }];

function renderEmployees() {
  const el = document.getElementById('employeeList');
  el.innerHTML = employees.map((e,i) => `
    <div class="flex gap-2 items-center">
      <input type="text" value="${e.name}" onchange="employees[${i}].name=this.value" class="w-24 px-2 py-2 rounded-lg text-sm" placeholder="ì´ë¦„">
      <input type="text" value="${e.salary}" oninput="formatNumber(this);employees[${i}].salary=this.value" class="flex-1 px-2 py-2 rounded-lg text-sm" placeholder="ì›”ê¸‰ì—¬">
      <button onclick="employees.splice(${i},1);renderEmployees()" class="px-2 py-2 rounded-lg text-red-500 hover:bg-red-50 dark:hover:bg-red-950 text-sm transition ${employees.length===1?'invisible':''}">âœ•</button>
    </div>
  `).join('');
}

function addEmployee() {
  employees.push({ name: 'ì§ì›'+(employees.length+1), salary: '' });
  renderEmployees();
}

function calcMulti() {
  const sz = document.getElementById('multiCompanySize').value;
  const ir = parseFloat(document.getElementById('multiIndustry').value);
  let tSal=0,tEmp=0,tWrk=0;
  const rows = employees.map(e => {
    const s = pn(e.salary);
    if (!s) return null;
    const c = calcInsurance(s, sz, ir);
    tSal+=s; tEmp+=c.totalE; tWrk+=c.totalW;
    return `<tr class="border-b border-border/50">
      <td class="px-4 py-2.5">${e.name}</td>
      <td class="text-right px-4 py-2.5 tabular-nums">${fmt(s)}</td>
      <td class="text-right px-4 py-2.5 tabular-nums">${fmt(c.totalE)}</td>
      <td class="text-right px-4 py-2.5 tabular-nums">${fmt(c.totalW)}</td>
      <td class="text-right px-4 py-2.5 tabular-nums">${fmt(c.totalE+c.totalW)}</td>
    </tr>`;
  }).filter(Boolean).join('');

  document.getElementById('multiResults').style.display = '';
  document.getElementById('multiBody').innerHTML = rows;
  document.getElementById('multiTotalSalary').textContent = fmt(tSal);
  document.getElementById('multiTotalEmployer').textContent = fmt(tEmp);
  document.getElementById('multiTotalEmployee').textContent = fmt(tWrk);
  document.getElementById('multiTotalAll').textContent = fmt(tEmp+tWrk);
}

// ===== ë‘ë£¨ëˆ„ë¦¬ =====
function checkDururi() {
  const workers = parseInt(document.getElementById('dururiWorkers').value)||0;
  const salary = pn(document.getElementById('dururiSalary').value);
  const isNew = document.getElementById('dururiNew').value === 'new';
  const period = document.getElementById('dururiPeriod').value;
  const div = document.getElementById('dururiResult');

  const eligible = workers < 10 && salary < 2700000;

  if (!eligible) {
    let reason = workers>=10 ? 'ê·¼ë¡œì ìˆ˜ê°€ 10ì¸ ì´ìƒì…ë‹ˆë‹¤.' : 'ì›” ê¸‰ì—¬ê°€ 270ë§Œì› ì´ìƒì…ë‹ˆë‹¤.';
    div.innerHTML = `<div class="rounded-xl bg-red-50 dark:bg-red-950/40 border border-red-200 dark:border-red-800 p-4"><p class="font-semibold text-red-700 dark:text-red-300">âŒ ì§€ì› ëŒ€ìƒì´ ì•„ë‹™ë‹ˆë‹¤</p><p class="text-sm text-red-600 dark:text-red-400 mt-1">${reason}</p></div>`;
    return;
  }

  if (!isNew) {
    div.innerHTML = `<div class="rounded-xl bg-amber-50 dark:bg-amber-950/40 border border-amber-200 dark:border-amber-800 p-4"><p class="font-semibold text-amber-700 dark:text-amber-300">âš ï¸ ê¸°ì¡´ê°€ì…ì ì§€ì› ì¢…ë£Œ</p><p class="text-sm text-amber-600 dark:text-amber-400 mt-1">2022ë…„ ì´í›„ ê¸°ì¡´ê°€ì…ì ì§€ì›ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì‹ ê·œê°€ì…ìë§Œ ì§€ì› ëŒ€ìƒì…ë‹ˆë‹¤.</p></div>`;
    return;
  }

  if (period === 'over') {
    div.innerHTML = `<div class="rounded-xl bg-amber-50 dark:bg-amber-950/40 border border-amber-200 dark:border-amber-800 p-4"><p class="font-semibold text-amber-700 dark:text-amber-300">â° ì§€ì› ê¸°ê°„ ì¢…ë£Œ</p><p class="text-sm text-amber-600 dark:text-amber-400 mt-1">ìµœëŒ€ 36ê°œì›” ì§€ì› ê¸°ê°„ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.</p></div>`;
    return;
  }

  const pensionAmt = (salary * R.pension.e / 100) + (salary * R.pension.w / 100);
  const employAmt = (salary * R.employ.e / 100) + (salary * R.employ.w / 100);
  const supportBase = pensionAmt + employAmt;
  const supportAmt = supportBase * 0.8;
  const remaining = period==='0' ? 36 : Math.max(0, 36 - parseInt(period));

  div.innerHTML = `<div class="rounded-xl bg-emerald-50 dark:bg-emerald-950/40 border border-emerald-200 dark:border-emerald-800 p-4">
    <p class="font-semibold text-emerald-700 dark:text-emerald-300">âœ… ë‘ë£¨ëˆ„ë¦¬ ì§€ì› ëŒ€ìƒ!</p>
    <div class="mt-2 text-sm text-emerald-600 dark:text-emerald-400 space-y-1">
      <p>ì‹ ê·œê°€ì…ì <strong>80% ì§€ì›</strong></p>
      <p>ì›” ì˜ˆìƒ ì§€ì›ê¸ˆ: <strong>${fmt(supportAmt)}</strong> (ì‚¬ì—…ì£¼+ê·¼ë¡œì, ì—°ê¸ˆ+ê³ ìš©)</p>
      <p>ì—°ê°„ ì˜ˆìƒ ì§€ì›ê¸ˆ: <strong>${fmt(supportAmt*12)}</strong></p>
      <p>ë‚¨ì€ ì§€ì› ê¸°ê°„: ì•½ <strong>${remaining}ê°œì›”</strong></p>
    </div>
  </div>`;
}

// ===== ë‹¤í¬ëª¨ë“œ =====
function toggleDark() {
  const html = document.documentElement;
  html.classList.toggle('dark');
  const isDark = html.classList.contains('dark');
  localStorage.setItem('4insure_dark', isDark);
  document.getElementById('darkIcon').textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
}

// ===== ì´ë¯¸ì§€ ì €ì¥ =====
function saveAsImage() {
  const el = document.getElementById('resultCapture');
  html2canvas(el, { backgroundColor: document.documentElement.classList.contains('dark') ? '#09090b' : '#ffffff', scale: 2 }).then(canvas => {
    const a = document.createElement('a');
    a.download = '4ëŒ€ë³´í—˜ë£Œ_ê³„ì‚°ê²°ê³¼.png';
    a.href = canvas.toDataURL();
    a.click();
  });
}
function saveMultiImage() {
  const el = document.getElementById('multiCapture');
  html2canvas(el, { backgroundColor: document.documentElement.classList.contains('dark') ? '#09090b' : '#ffffff', scale: 2 }).then(canvas => {
    const a = document.createElement('a');
    a.download = '4ëŒ€ë³´í—˜ë£Œ_ë‹¤ì¤‘ì§ì›.png';
    a.href = canvas.toDataURL();
    a.click();
  });
}

// ===== Init =====
(function init() {
  if (localStorage.getItem('4insure_dark')==='true') {
    document.documentElement.classList.add('dark');
    document.getElementById('darkIcon').textContent = 'â˜€ï¸';
  }
  loadRates();
  renderEmployees();
})();
</script>
</body>
</html>
